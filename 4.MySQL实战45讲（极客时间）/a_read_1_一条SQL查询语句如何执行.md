# 一条SQL查询语句如何执行

* 数据库中长连接：连接成功后，如果客户端持续有请求，则使用同一个连接。（通产使用长连接）
* 数据库中短连接：连接成功后，每执行完很少的几次查询就断开连接，下次查询再新建立一个。
* 长连接积累下来会占用很多内存，导致OOM，现象就是MySQL异常重启。要解决可以在业务中进行大查询后断开重连，或者5.7版本后可以通过mysql_reset_connection 来重连，这个不会断连接和权限校验，只是回到刚创建时的状态。
* 查询缓存：MySQL拿到一个查询的时候，回去查询缓存中查找。之前执行过得语句回通过key-value的形式在查询缓存中保存，key时sql，value时查询结果。
* 大多数情况下不建议使用查询缓存，应为查询缓存的失效率非常的高，只要对一张表跟新，这个表上的所有查询缓存就会被清空。应为查询缓存的命中率时很低的。（MySQL8.0开始就没有查询缓存的功能）
* 分析器：词法分析：就是讲一个个输入的字符串解析成关键字，表名，列名，函数等；语法分析器：就是检查使用的语法是否正确。
* 优化器：通过分析器，MySQL就知道你要干什么，在执行之前，优化器在进行优化：在表中有多个索引的时候，决定使用哪个索引；或者在多表关联的时候，决定连接的顺序等。